# Minimum Design Requirements

## Overview

A command is an input from outside the system. Events contain all the information we want to persist. A state is recovered from events and used to handle a command.

The system receives a command and looks up the command handler for that. It may read events to recover zero or more states. It generates zero or more events or rejects the command. The emitted events are persisted in a database. If another event that has the same ID and version, the write request needs to get rejected and the command handler fails. Projections can read these events to make side effects such as updating databases or sending events to external systems.

### Event

An event is an immutable record persisted in a database. Each event should at least have an ID, monotonously increasing version number, and data that represents a state transition. Example: group: `cart`, id: `cartId-123` , version: `5`, content: `{"_name": "ItemAdded", "itemId": 41, "count": 2}`

### Event Group

An event group literary groups events. Event versions inside a single event group should be monotonously increased in the insertion order. In other words, insertion order of events across multiple event groups is not precisely preserved though it can be roughly understood by timestamps. (In general, processes don't have an accurate clock.)

### Projection

A projection is an event consumer. Projections can be used to run side effects (e.g. updating a table, sending an email) based on persisted events. Since each event is immutable and has a unique version, they can be safely consumed concurrently for each use case as many times as required. Typically, projections are handled by separate processes for scalability and typically designed as eventual consistency and at-least-once semantics.

### Command

A command is an input from outside the system. It's mostly the same as a standard POST or PUT HTTP requests. A command handler receives a pair of command and state, might call some external services, and generate events or reject the command.

### Command Handler

A command is a request to generate events. A command handler is used for that. We have no constraints for command handlers at this point.&#x20;

### Event Handler

A event handler generates the next state by consuming the next event and the previous state. The function should not depend on other data other than the state and event. A predefined initial state and an event v1 generate a state v1, and the state v1 and an event v2 generate state v2, and so on.&#x20;

### State

In the context of Event Sourcing, a state is data that is consumed by a command handler. Unlike traditional systems, a state is not directly stored in a database but gets generated by replaying events by using the event handler for the state. The function to generate a state based on an event and state is called an event handler. The state recovery process can be regarded as a projection.
